function receiptSelect(){$.ajax({type:"post",url:lData.getUrl+"addressManager",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userId:lData.userId,way:1}))},async:!0,dataType:"json",success:function(e){0==e.addlist.length?receiptPopup():receiptFilldata(e)}})}function receiptFilldata(e){$(".receipt-list").length>0&&$(".receipt-list").remove(),$.each(e.addlist,function(e,t){$("#p-receipt").find(".content").append('<div class="card receipt-list"><div class="card-content"><div class="card-content-inner"><p><span>'+t.name+'</span><span class="test2">'+t.telephone+"</span></p><p>"+function(e,t,a,r,s){return e&&"undefined"!=e&&"null"!=e?r&&"undefined"!=r&&"null"!=r?e+t+a+r+s:e+t+a+s:s}(t.address1,t.address2,t.address3,t.address4,t.address)+'</p></div></div><div class="card-footer"><label onclick="setDefaultAddress('+t.id+',this);" class="receipt-radio label-checkbox item-content"><input '+defaultAddress(t.isDefault)+' type="radio" name="defaule-address"><div class="item-media"><i class="icon icon-form-checkbox"></i></div><div class="radio-text">设为默认地址</div></label><div onclick="receiptPopup('+t.id+",'"+t.name+"',"+t.telephone+",'"+t.address+"',"+t.code1+","+t.code2+","+t.code3+","+t.code4+",'"+t.address1+"','"+t.address2+"','"+t.address3+"','"+t.address4+'\');" class="button button-dark" style="position: absolute;right: 5rem;">编辑地址</div><div onclick="receiptDelete('+t.id+',this);" class="button button-dark" style="position: absolute;right: .75rem;">删除地址</div></div></div>')})}function defaultAddress(e){if(1==e)return"checked=checked"}function setDefaultAddress(e,t){$(t).parent().find("input:checked").length>0||($.showIndicator(),setTimeout(function(){$.ajax({type:"post",url:lData.getUrl+"addressManager",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userId:lData.userId,way:5,addressId:e}))},async:!0,dataType:"json",success:function(e){0==e.stateCode?$.toast("设置成功",1e3):$.alert(e.message),$.hideIndicator()}})},200))}function receiptPopup(e,t,a,r,s,d,i,c,n,l,p,o){var v=e?e:"",u=t?t:"",k=a?a:"",f=r?r:"";$.popup('<div class="popup receipt-popup"><header class="bar bar-nav c_header"><a class="icon pull-left close-popup"  style="font-size:.8rem;">取消</a><h1 class="title">'+function(e){return e?"编辑":"新增"}(e)+'收货地址</h1><a class="icon pull-right" onclick="receiptSave('+v+');">保存</a></header><div class="content"><div class="list-block"><ul><li class="item-content"><input class="receipt-name" type="text" placeholder="收货人姓名" value="'+u+'" /></li><li class="item-content"><input class="receipt-tel" type="text" placeholder="手机号码" value="'+k+'" /></li><li class="item-content u-address-choose"><span>所在地区</span><input type="text" id="picker" readonly /><a class="icon icon-right"></a></li><li class="item-content"><textarea class="receipt-address" type="text" placeholder="详细地址 （街道、楼牌号等）">'+f+"</textarea></li></ul></div></div></div>",!0),s&&"null"!=s&&"undefined"!=s&&($("#picker").attr("data-lv1",s),$("#picker").attr("data-lv2",d),$("#picker").attr("data-lv3",i),c?$("#picker").attr("data-lv4",c):$("#picker").removeAttr("data-lv4")),n&&"undefined"!=n&&"null"!=n?o&&"undefined"!=o&&"null"!=o?($("#picker").val(n+l+p+o),$("#picker").attr("data-lvname1",n),$("#picker").attr("data-lvname2",l),$("#picker").attr("data-lvname3",p),$("#picker").attr("data-lvname4",o)):($("#picker").val(n+l+p),$("#picker").attr("data-lvname1",n),$("#picker").attr("data-lvname2",l),$("#picker").attr("data-lvname3",p)):($("#picker").val(""),$(".receipt-address").val("")),_getScript("js/address-picker.js",function(){addPicker()})}function receiptSave(e){var t=$(".receipt-name"),a=$(".receipt-tel"),r=$(".receipt-address"),s=/^(0|86|17951)?1\d{10}$/.test(a.val());return t.val()?s?$("#picker").val()?r.val()?void(t.val()&&s&&r.val()&&(e?receiptUpdate(e,t.val(),a.val(),r.val()):receiptInsert(t.val(),a.val(),r.val()))):void $.toast("详细地址不能未空",1e3):void $.toast("请选择地址",1e3):void $.toast("请输入正确的手机号码",1e3):void $.toast("收货人姓名不能未空",1e3)}function receiptInsert(e,t,a){$.ajax({type:"get",url:lData.getUrl+"addressManager",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userId:lData.userId,way:2,address:a,telephone:t,name:e,code1:$("#picker").attr("data-lv1"),code2:$("#picker").attr("data-lv2"),code3:$("#picker").attr("data-lv3"),code4:$("#picker").attr("data-lv4")?$("#picker").attr("data-lv4"):"0",address1:$("#picker").attr("data-lvname1"),address2:$("#picker").attr("data-lvname2"),address3:$("#picker").attr("data-lvname3"),address4:$("#picker").attr("data-lvname4")?$("#picker").attr("data-lvname4"):""}))},async:!0,dataType:"json",success:function(e){0==e.stateCode?($.closeModal(".receipt-popup"),receiptFilldata(e)):$.alert(e.message)}})}function receiptDelete(e,t){$.confirm("是否确认删除?",function(){$.ajax({type:"post",url:lData.getUrl+"addressManager",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userId:lData.userId,way:4,addressId:e}))},async:!0,dataType:"json",success:function(e){0==e.stateCode?($(t).parents(".card").remove(),0==$(".receipt-list").length&&window.sessionStorage.removeItem("prizeAddress")):$.alert(e.message)}})})}function receiptUpdate(e,t,a,r){$.ajax({type:"get",url:lData.getUrl+"addressManager",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userId:lData.userId,way:3,addressId:e,address:r,telephone:a,name:t.toString(),code1:$("#picker").attr("data-lv1"),code2:$("#picker").attr("data-lv2"),code3:$("#picker").attr("data-lv3"),code4:$("#picker").attr("data-lv4")?$("#picker").attr("data-lv4"):"0",address1:$("#picker").attr("data-lvname1"),address2:$("#picker").attr("data-lvname2"),address3:$("#picker").attr("data-lvname3"),address4:$("#picker").attr("data-lvname4")?$("#picker").attr("data-lvname4"):""}))},async:!0,dataType:"json",success:function(e){0==e.stateCode&&($.closeModal(".receipt-popup"),receiptFilldata(e))}})}function receiptLinkTo(){$(".j-receipt-insert").click(function(){receiptPopup()})}$(function(){try{receiptSelect(),receiptLinkTo()}catch(e){}});