function bindTelGetYZM(){var e=$("#p-bindtel").find(".j-bindtel-tel"),t=$("#p-bindtel").find(".j-bindtel-yzm");null!=window.sessionStorage.getItem("yzmtel")&&e.val(window.sessionStorage.getItem("yzmtel")),$("#p-bindtel").find(".get_yzm").click(function(){if(((new Date).getTime()-cookie.getCookie("yzmtime"))/1e3<100)return void $.alert("请勿频繁发送");var t=/^(0|86|17951)?1\d{10}$/.test(e.val());t?_getScript("js/yzmDY.js",function(){yzmDY(e,"bind"),bindTelYZMCutDown(100)}):(e.addClass("ipt-error"),$("<span class='ipt-error-text'>请输入正确的手机号</span>").insertAfter(e))}),$("#p-bindtel").find(".j-bind-button").click(function(){var n=/^(0|86|17951)?1\d{10}$/.test(e.val());if(!n){if(e.hasClass("ipt-error").length>0)return;e.addClass("ipt-error"),$("<span class='ipt-error-text'>请输入正确的手机号</span>").insertAfter(e)}if(!t.val()){if(t.hasClass("ipt-error").length>0)return;t.addClass("ipt-error"),$("<span class='ipt-error-text'>请输入验证码</span>").insertAfter(t)}n&&t.val()&&(window.sessionStorage.getItem("yzm")==t.val()&&window.sessionStorage.getItem("yzmtel")==e.val()?($.showIndicator(),bindTelBind(e.val())):window.sessionStorage.getItem("yzmtel")!=e.val()&&null!=window.sessionStorage.getItem("yzmtel")?0==$(".ipt-error").length&&(e.addClass("ipt-error"),$("<span class='ipt-error-text'>请输入正确的手机号</span>").insertAfter(e)):$.alert("验证码输入错误"))}),e.focus(function(){e.removeClass("ipt-error"),$(".ipt-error-text").remove()}),t.focus(function(){t.removeClass("ipt-error"),$(".ipt-error-text").remove()})}function bindTelBind(e){$.showIndicator(),$.ajax({type:"post",url:lData.getUrl+"resetTelephone",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userKey:window.localStorage.getItem("userKey"),telephone:e}))},async:!0,dataType:"json",success:function(e){0==e.stateCode&&(lData.userInfo=e.userInfo,setTimeout(function(){$.hideIndicator(),$.alert("设置成功",function(){$.router.back()})},200))}})}function bindTelYZMCutDown(e){var t=setInterval(function(){e-=1,$("#p-bindtel").find(".get_yzm").html(e+"s后重新发送"),e<=0&&(clearInterval(t),$("#p-bindtel").find(".get_yzm").html("获取验证码"))},1e3)}$(function(){try{lData.userInfo.usertelephone?$("#p-bindtel").find("h1.title").html("修改手机号"):$("#p-bindtel").find("h1.title").html("添加手机号"),bindTelGetYZM();var e=100-Math.ceil(((new Date).getTime()-cookie.getCookie("yzmtime"))/1e3);e>0&&cookie.getCookie("yzmtime")?bindTelYZMCutDown(e):$("#p-bindtel").find(".get_yzm").html("获取验证码")}catch(e){}});