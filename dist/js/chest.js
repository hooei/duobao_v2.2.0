function chestFillData(e){$(".chest_model").length>0&&null==window.localStorage.getItem("chestForceRefresh")||($(".chest_model").remove(),$.showIndicator(),$.ajax({type:"get",url:luanmingli.getUrl+"getTreasureList",data:{currentPage:e,order:1,type:2,v:luanmingli.srvVersion},async:!0,dataType:"json",success:function(t){e>t.totalPage||($.each(t.treasureInfoList,function(e,t){appendData("#p-chest .content",t)}),window.localStorage.removeItem("chestForceRefresh"),setTimeout(function(){$.hideIndicator()},500))}}))}function appendData(e,t){$(e).append('<div onclick="routerToDuobao('+t.treasureId+')" class="chest_model card"><div valign="bottom" class="card-header color-white no-border no-padding"><img class="card-cover" src='+t.goodsInfo.picUrl+' alt=""></div><div class="card-content"><div class="card-content-inner list_info"><div class="clearfix stage_info"><p class="stage_text"><span>'+t.goodsInfo.describe+'</span></p></div><div class="clearfix"><div class="schedule pull-left clearfix"><div class="schedule_bar"><div class="scheduling" style="width:'+t.participantCount/t.totalCount*100+'%;"></div></div><div class="pull-left"><p class="schedule_percent">'+t.totalCount+'</p><p>总需</p></div><div class="schedule_text2 pull-right"><p class="schedule_person">'+(t.totalCount-t.participantCount)+'</p><p>剩余</p></div></div><button class="global_button participate button pull-right">立即夺宝</button></div></div></div></div>')}function chestRefresh(){$(".chest_model").remove(),chestFillData(1)}function routerToDuobao(e){$.showIndicator(),$.router.load("duobao.html?treasureId="+e)}$(function(){try{chestFillData(1),dropRefresh("#p-chest",chestRefresh)}catch(e){}});