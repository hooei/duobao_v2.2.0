function bonusFilluanmingli(){$.ajax({type:"post",url:luanmingli.getUrl+"getUserHongbaoList",data:{v:luanmingli.srvVersion,userId:luanmingli.userId},dataType:"json",async:!0,success:function(s){if(0==s.stateCode){$("#bonustab1").find(".card").remove(),$("#bonustab2").find(".card").remove(),$("#p-bonus").find(".no-bonus").remove();var a=0,t=(new Date).getTime();$.each(s.hongbaoList,function(s,e){function n(s){var a=new Date(s),t=new Date;return s-t.getTime()>864e5?a.getDate()-t.getDate()+"天":parseInt(a.getHours())+24-t.getHours()+"小时"}e.endTime-t<864e5&&0==e.status&&(a+=1);var i=function(s){var a=new Date(s),t=a.getFullYear(),e=a.getMonth()+1<10?"0"+(a.getMonth()+1):a.getMonth()+1,n=a.getDate()<10?"0"+a.getDate():a.getDate();return t+"-"+e+"-"+n};0==e.status?$("#bonustab1").append('<div class="card bonus-card"><div class="card-content clearfix"><div class="card-money pull-left"><p class="text1">¥<span class="a-bonus-money">'+e.disCount+'</span></p><p class="text2">满'+e.usePoint+'元使用</p></div><div class="card-time pull-left"><div class="card-time-left"><p class="text1">'+e.hongbaoName+'</p><p class="text2">'+e.validity+'后过期</p></div><div class="card-time-right">可使用</div></div></div></div>'):1==e.status?$("#bonustab2").append('<div class="card bonus-card bonus-used-card"><div class="card-content clearfix"><div class="card-money pull-left"><p class="text1">¥<span class="a-bonus-money">'+e.disCount+'</span></p><p class="text2">满'+e.usePoint+'元使用</p></div><div class="card-time pull-left"><div class="card-time-left"><p class="text1">'+e.hongbaoName+'</p><p class="text2">有效期至'+i(e.endTime)+'</p></div><div class="card-time-right">已使用</div></div></div></div>'):2==e.status?$("#bonustab1").append('<div class="card bonus-card bonus-expired-card"><div class="card-content clearfix"><div class="card-money pull-left"><p class="text1">¥<span class="a-bonus-money">'+e.disCount+'</span></p><p class="text2">满'+e.usePoint+'元使用</p></div><div class="card-time pull-left"><div class="card-time-left"><p class="text1">'+e.hongbaoName+'</p><p class="text2">有效期至'+i(e.endTime)+'</p></div><div class="card-time-right">已过期</div></div></div></div>'):3==e.status&&$("#bonustab1").append('<div class="card bonus-card bonus-toEffective-card"><div class="card-content clearfix"><div class="card-money pull-left"><p class="text1">¥<span class="a-bonus-money">'+e.disCount+'</span></p><p class="text2">满'+e.usePoint+'元使用</p></div><div class="card-time pull-left"><div class="card-time-left"><p class="text1">'+e.hongbaoName+'</p><p class="text2">'+n(e.startTime)+'后生效</p></div><div class="card-time-right">待生效</div></div></div></div>')}),$("#p-bonus .j-notuse .a-deadline").show(),$("#p-bonus .j-notuse .a-deadline").html('有<span style="color:#f24957;">'+a+"</span>个红包即将到期"),0==$("#bonustab1").find(".card").length&&($("#p-bonus .j-notuse .a-deadline").hide(),$("#bonustab1").append('<div class="no-bonus"><p>您当前没有红包哦</p><p>快去夺宝得红包吧</p></div>')),0==$("#bonustab2").find(".card").length&&$("#bonustab2").append('<div class="no-bonus"><p>您当前没有红包哦</p><p>快去夺宝得红包吧</p></div>')}else $.alert(s.message)}})}function bonusExplanation(){$("#p-bonus").find(".explanation").click(function(){$.router.load("bonus-help.html")})}$(function(){try{bonusFilluanmingli(),bonusExplanation()}catch(s){}});