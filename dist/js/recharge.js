function recharge(){var e=$("#p-recharge").find(".choose-num").find(".button");e.click(function(){e.removeClass("choose-num-color"),$(this).addClass("choose-num-color")});var t,o=$("input[type=radio]:checked").attr("class");"wx"==o?t=1:"zfb"==o&&(t=2),$("#p-recharge").find(".recharge-button").click(function(){var e=$("#p-recharge").find(".choose-num").find(".choose-num-color").html()||$("#p-recharge").find(".choose-num").find(".choose-num-color").val();e?/^[0-9]*$/.test(e)?preRecharge(t,e):$.alert("请输入正确的金额"):$.alert("请选择或输入充值金额")})}function preRecharge(e,t){var o="http://www.2333db.com/callback/callback_empty.html";(lData.qktId||lData.thirdId||navigator.userAgent.indexOf("QQ")>-1)&&(o=window.location.href);var a=lData.getUrl+"preCharge?v="+lData.srvVersion+"&content="+encodeURIComponent(encryptByDES(JSON.stringify({way:e,userId:lData.userId,points:t,callBackUrl:o,paySuccessUrl:o})));zfbRecharge(a)}function zfbRecharge(e){window.sessionStorage.setItem("pointsNum",lData.userInfo.detailInfo.points),checkRecharge(),lData.qktId&&!lData.qkt.backUrl||lData.thirdId||navigator.userAgent.indexOf("QQ")>-1?window.location.href=e:window.open(e)}function checkRecharge(){if(null!=window.sessionStorage.getItem("pointsNum")){var e=window.sessionStorage.getItem("pointsNum");$.confirm("是否已完成支付?",function(){$.showIndicator(),setTimeout(function(){$.ajax({type:"post",url:lData.getUrl+"userDetail",data:{v:lData.srvVersion,content:encryptByDES(JSON.stringify({userId:window.localStorage.getItem("userId")}))},async:!0,dataType:"json",success:function(t){t.userInfo.detailInfo.points>e?(window.sessionStorage.removeItem("pointsNum"),$.router.load("recharge-success.html")):(window.sessionStorage.removeItem("pointsNum"),$.router.load("recharge-fail.html"))}})},200)})}}$(function(){try{window.sessionStorage.getItem("fromActRecharge")&&window.sessionStorage.removeItem("fromActRecharge"),recharge(),checkRecharge()}catch(e){}});